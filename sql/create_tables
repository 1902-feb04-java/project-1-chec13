CREATE SCHEMA project1_schema;

SET search_path TO project1_schema;

CREATE TABLE positions
(
	id SERIAl NOT NULL,
	name VARCHAR(100) NOT NULL,
	
	CONSTRAINT pk_positions_id PRIMARY KEY (id)
);
CREATE TABLE employee
(
	id SERIAL NOT NULL,
	first_name VARCHAR(100) NOT NULL,
	last_name VARCHAR(100) NOT NULL,
	position_id INTEGER NOT NULL,
	manager_id INTEGER NOT NULL,
	username VARCHAR(20) NOT NULL,
	password VARCHAR(20) NOT NULL,
	email VARCHAR(100) NOT NULL,
	start_date DATE NOT NULL,
	
	CONSTRAINT pk_employee_id PRIMARY KEY (id),
	CONSTRAINT fk_position_id FOREIGN KEY (position_id) REFERENCES positions (id)
);
CREATE TABLE reimbursements_status
(
	id SERIAL NOT NULL,
	name VARCHAR(100) NOT NULL,
	CONSTRAINT pk_reimbursements_status_id PRIMARY KEY (id)
);
CREATE TABLE reimbursements
(
	id SERIAL NOT NULL,
	amount NUMERIC(6,2) NOT NULL,
	info TEXT,
	status_id INTEGER NOT NULL,
	requestee_id INTEGER NOT NULL,
	resolver_id INTEGER NOT NULL,
	request_time TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT (CURRENT_TIMESTAMP),
	resolve_time TIMESTAMP WITH TIME ZONE,
	
	CONSTRAINT pk_reimbursements_id PRIMARY KEY (id),
	CONSTRAINT fk_status_id FOREIGN KEY (status_id) REFERENCES reimbursements_status (id),
	CONSTRAINT fk_requestee_id FOREIGN KEY (requestee_id) REFERENCES employee (id),
	CONSTRAINT fk_resolver_id FOREIGN KEY (resolver_id) REFERENCES employee(id)
)